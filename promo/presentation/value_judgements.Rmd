---
title: "Value judgements"
subtitle: "Using flipbookr and xaringan"
author: "Me"
output: html_document
---



```{r, include = T}
library(tidyverse)
readLines("https://raw.githubusercontent.com/clauswilke/dviz.supp/master/R/stamp.R") %>% 
  writeLines("stamp.R")

source("stamp.R")

tidytitanic::passengers %>% 
  tibble() %>% 
  mutate(cat_survived = ifelse(survived, "survived", "not survived"), 
         .before = 1)

judge <- function(p, color, alpha, label, family = dviz_font_family_bold,
                  fontface = "plain", clip = "on")
{
  ggdraw(p, clip = clip) +
    draw_text(paste0(label, "  "), x=1, y=1, vjust=1.1, hjust=1, size=35, angle = 0,
              color=color, alpha=alpha, family = family, fontface = fontface) +
    draw_line(c(1, 1), c(0, 1), size=2.8, color=color, alpha=alpha)
}

theme_set(new = theme_classic(base_size = 30) + theme(plot.margin = margin(50,20,30,10)))

tidytitanic::passengers %>% 
  mutate(adult = age >=18 ) %>% 
  filter(!is.na(age)) %>% 
ggplot() + 
  aes(x = adult) + 
  geom_bar() ->
  p; p
  
library(cowplot)
p %>% judge(family = "Helvetica", color = "red", alpha = .9, label = "ugly", fontface = "bold")


p + 
  facet_grid(~ survived) ->
p2

p2 %>% judge(family = "Helvetica", color = "red", alpha = .9, label = "bad", fontface = "bold")

```



